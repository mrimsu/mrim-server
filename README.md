# MRIM-Server
> [!WARNING]
> –ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç WIP, –Ω–µ–ø–æ–ª–Ω–∞—è —Ä–µ–ø–ª–∏–∫–∞.

–≠–º—É–ª—è—Ç–æ—Ä —Å–µ—Ä–≤–µ—Ä–∞ –ê–≥–µ–Ω—Ç Mail.ru, —Ä–µ–∞–ª–∏–∑—É—é—â–∏–π –ø—Ä–æ—Ç–æ–∫–æ–ª MRIM.

–°–µ—Ä–≤–µ—Ä –∏–º–∏—Ç–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ –≤–µ—Ä—Å–∏–∏ 1.8 –¥–æ 1.23. –ë–æ–ª–µ–µ –º–ª–∞–¥—à–∏–µ –≤–µ—Ä—Å–∏–∏ –ø–æ–∫–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç —Å —ç—Ç–∏–º —Å–µ—Ä–≤–µ—Ä–æ–º.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞

- –õ—é–±–æ–π –∫–æ–º–ø—å—é—Ç–µ—Ä –Ω–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–µ x86_64 –∏–ª–∏ ARM64 (aarch64)
- –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ Windows, macOS –∏–ª–∏ –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤ —Å —è–¥—Ä–æ–º Linux (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–µ–µ)
- Node.js v16 –∏–ª–∏ –º–ª–∞–¥—à–µ, —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è –Ω–∞ v22 LTS
- MariaDB (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–µ–µ) –∏–ª–∏ –ª—é–±–æ–π –¥—Ä—É–≥–æ–π SQL —Å–µ—Ä–≤–µ—Ä

## –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Node.js, npm, MariaDB
2. –°–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ —ç—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –≤ –ª—é–±—É—é —É–¥–æ–±–Ω—É—é –ø–∞–ø–∫—É
3. –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Ç—É–¥–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `mrimdb.sql`
4. –ü—Ä–æ–ø–∏—à–∏—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏ `npm i`, –∞ –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ `npm audit fix`
5. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Å–µ—Ä–≤–µ—Ä, —Å–º. [–Ω–∞—Å—Ç—Ä–æ–π–∫–∞](/docs/config.md)
6. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä –∫–æ–º–∞–Ω–¥–æ–π `npm start`

–ï—Å–ª–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –≤—ã—Ö–æ–¥–∏—Ç –æ—à–∏–±–∫–∞ `Could not load the "sharp" module using the linux runtime`, –≤–≤–µ–¥–∏—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏ `npm install sharp`

–ó–∞ —Å–µ—Ä–≤–µ—Ä–æ–º –≤—ã –º–æ–∂–µ—Ç–µ —Å–ª–µ–¥–∏—Ç—å —Å –ø–æ–º–æ—â—å—é REST API, —Å–º. [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é](/docs/rest.md)

## –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã

### –õ–µ–≥–µ–Ω–¥–∞

‚úÖ - –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–æ–≤–µ—Ä–µ–Ω –∏ —Å–æ–≤–º–µ—Å—Ç–∏–º —Å —Å–µ—Ä–≤–µ—Ä–æ–º

üü° - –ß–∞—Å—Ç–∏—á–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º —Å —Å–µ—Ä–≤–µ—Ä–æ–º (–µ—Å—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –±–∞–≥–∏)

üü† - –ß–∞—Å—Ç–∏—á–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º, –Ω–æ –µ—Å—Ç—å —Å–µ—Ä—å—ë–∑–Ω—ã–µ –±–∞–≥–∏, –º–µ—à–∞—é—â–∏–µ —Ä–∞–±–æ—Ç–µ –∫–ª–∏–µ–Ω—Ç–∞

üî¥ - –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –°–ø–∏—Å–æ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤

| –°—Ç–∞—Ç—É—Å | –ö–ª–∏–µ–Ω—Ç | –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π | 
| ------ | ------ | --------- | ----------- |
| ‚úÖ | –ê–≥–µ–Ω—Ç@Mail.ru –≤–µ—Ä—Å–∏–∏ 4.10 (—Å–±–æ—Ä–∫–∞ 1952) | Windows | –†–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ –∏–Ω—ä–µ–∫—Ç–æ—Ä –∏–ª–∏ –∑–∞–º–µ–Ω—É –≤ —Ä–µ–µ—Å—Ç—Ä–µ. |
| ‚úÖ | –ê–≥–µ–Ω—Ç@Mail.ru –≤–µ—Ä—Å–∏–∏ 5.0 (—Å–±–æ—Ä–∫–∞ 2094) | Windows | –†–∞–±–æ—Ç–∞–µ—Ç. |
| ‚úÖ | –ê–≥–µ–Ω—Ç@Mail.ru –≤–µ—Ä—Å–∏–∏ 5.1 (—Å–±–æ—Ä–∫–∞ 2190) | Windows | –†–∞–±–æ—Ç–∞–µ—Ç (–ø–µ—Ä–≤–∞—è –≤–µ—Ä—Å–∏—è —Å UTF-16LE). |
| ‚úÖ | –ê–≥–µ–Ω—Ç@Mail.ru –≤–µ—Ä—Å–∏–∏ 5.5 (—Å–±–æ—Ä–∫–∞ 2842) | Windows | –†–∞–±–æ—Ç–∞–µ—Ç. |
| ‚úÖ | –ê–≥–µ–Ω—Ç@Mail.ru –≤–µ—Ä—Å–∏–∏ 5.7 (—Å–±–æ—Ä–∫–∞ 3797) | Windows | –†–∞–±–æ—Ç–∞–µ—Ç. |
| ‚úÖ | –ê–≥–µ–Ω—Ç@Mail.ru –≤–µ—Ä—Å–∏–∏ 5.9 (—Å–±–æ—Ä–∫–∞ 4876) | Windows | –†–∞–±–æ—Ç–∞–µ—Ç, —Ç—Ä–µ–±—É–µ—Ç SSL. |
| ‚úÖ | –ê–≥–µ–Ω—Ç@Mail.ru –≤–µ—Ä—Å–∏–∏ 6.3 (—Å–±–æ—Ä–∫–∞ 8065) | Windows | –†–∞–±–æ—Ç–∞–µ—Ç. |
| üü† | –ê–≥–µ–Ω—Ç@Mail.ru –≤–µ—Ä—Å–∏–∏ 6.5 (—Å–±–æ—Ä–∫–∞ 9316) | Windows | –í—ã–ª–µ—Ç–∞–µ—Ç –∏–ª–∏ –∑–∞–≤–∏—Å–∞–µ—Ç –µ—Å–ª–∏ —É –∫–æ–Ω—Ç–∞–∫—Ç–∞ –º–µ–Ω—è–µ—Ç—Å—è —Å—Ç–∞—Ç—É—Å. –ù–æ —Ä–∞–±–æ—Ç–∞–µ—Ç.  |
| ‚úÖ | QIP Infium (—Å–±–æ—Ä–∫–∞ 9044) | Windows | –†–∞–±–æ—Ç–∞–µ—Ç, —Å–µ—Ä–≤–µ—Ä–æ–º –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –µ–≥–æ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏. |
| ‚úÖ | –ê–≥–µ–Ω—Ç@Mail.ru –≤–µ—Ä—Å–∏–∏ 2.1 | Mac OS X | –†–∞–±–æ—Ç–∞–µ—Ç, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤ hosts –ø—Ä–æ–ø–∏—Å–∞—Ç—å –ª—é–±–æ–π –∞–π–ø–∏ –Ω–∞ mrim.mail.ru |
| ‚úÖ | –ú–æ–±–∏–ª—å–Ω—ã–π –ê–≥–µ–Ω—Ç@Mail.ru –≤–µ—Ä—Å–∏–∏ 1.1 | Java / J2ME | –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—á–∏–π. |
| ‚úÖ | –ú–æ–±–∏–ª—å–Ω—ã–π –ê–≥–µ–Ω—Ç@Mail.ru –≤–µ—Ä—Å–∏–∏ 1.3 | Java / J2ME | –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—á–∏–π. –ù–µ–æ–±—Ö–æ–¥–∏–º –ø–∞—Ç—á –∫–ª–∏–µ–Ω—Ç–∞ —Å–æ —Å–º–µ–Ω–æ–π –∞–¥—Ä–µ—Å–∞. |
| ‚úÖ | Jimm aspro 0.6.0 —Å MRIM | Java / J2ME | –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–∫–ª—é—á–∏—Ç—å Windows-1251 –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö; –Ω–µ–æ–±—Ö–æ–¥–∏–º –ø–∞—Ç—á –∫–ª–∏–µ–Ω—Ç–∞ —Å–æ —Å–º–µ–Ω–æ–π –∞–¥—Ä–µ—Å–∞. |
| ‚úÖ | jMailAgent 0.5.27 | Java / J2ME | –†–∞–±–æ—Ç–∞–µ—Ç, –∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞ –º–µ–Ω—è–µ—Ç—Å—è –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö. |
| üî¥ | –ê–≥–µ–Ω—Ç@Mail.ru 2.0.0 | Windows Mobile | –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–µ–≤–µ—Ä–Ω—ã–π `MRIM_CS_LOGIN2` —Å –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—é—â–∏–º LPS —Å Useragent. |
| ‚úÖ | –ê–≥–µ–Ω—Ç@Mail.ru –≤–µ—Ä—Å–∏–∏ 2.2 | Android | –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—á–∏–π. –ù–µ–æ–±—Ö–æ–¥–∏–º –ø–∞—Ç—á –∫–ª–∏–µ–Ω—Ç–∞ —Å–æ —Å–º–µ–Ω–æ–π –∞–¥—Ä–µ—Å–∞. |
| ‚úÖ | –ê–≥–µ–Ω—Ç@Mail.ru –≤–µ—Ä—Å–∏–∏ 3.2 | Android | –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—á–∏–π. |

### –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –ø–∞—Ç—á–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤

#### –ê–≥–µ–Ω—Ç@Mail.ru

–ê–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞ –º–æ–∂–Ω–æ –ø–æ–º–µ–Ω—è—Ç—å —á–µ—Ä–µ–∑ —Ä–µ–µ—Å—Ç—Ä: –°–æ–∑–¥–∞—Ç—å REG_SZ –≤ `HKCU\Software\Mail.Ru\Agent\strict_server` –≤ —Ñ–æ—Ä–º–∞—Ç–µ `IP:PORT` –ª–∏–±–æ `DOMAIN:PORT`

–ù–∞ –≤–µ—Ä—Å–∏–∏ MRA 5.8 –∏ –≤—ã—à–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è SSL. –û—Ç–∫–ª—é—á–∏—Ç—å –µ–≥–æ –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤ REG_SZ –≤ `HKCU\Software\Mail.Ru\Agent\ssl` —Å —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ–º `deny`

#### QIP Infium

–ê–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞ –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö.

–ü—Ä–∞–≤–¥–∞, QIP Infium –ø—Ä–æ—Å—Ç–æ —Ç–∞–∫ –Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –±–µ–∑ –∞–∫–∫–∞—É–Ω—Ç–∞ qip.ru. –ï—Å—Ç—å –¥–≤–∞ –ø—É—Ç–∏ –¥–ª—è –µ–≥–æ –æ–±—Ö–æ–¥–∞:

1. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å QIP –≤ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `/isolated`, —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å, –∏ —Ç–∞–º –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç –ê–≥–µ–Ω—Ç–∞.
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å QIP Infium, –Ω–∞–∂–∞—Ç—å –ü–ö–ú –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫—É –∏ –≤—ã–±—Ä–∞—Ç—å `Run Modifiers`, –ø–æ—Å—Ç–∞–≤–∏—Ç—å –≥–∞–ª–æ—á–∫—É –Ω–∞ `/isolated`, –∏ –≤—Å–µ, —á—Ç–æ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è –Ω–∞ `Patch`.

#### –ú–æ–±–∏–ª—å–Ω—ã–π –ê–≥–µ–Ω—Ç@Mail.ru (Java / J2ME)

–í –≤–µ—Ä—Å–∏—è—Ö –¥–æ 1.1 –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞ –º–µ–Ω—è–µ—Ç—Å—è –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö. –ö–ª–∏–µ–Ω—Ç–∞–º —Å—Ç–∞—Ä—à–µ –Ω—É–∂–µ–Ω –ø–∞—Ç—á.

#### –ê–≥–µ–Ω—Ç@Mail.ru (Android)

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–∞–∑–æ–±—Ä–∞—Ç—å .apk —Ñ–∞–π–ª —á–µ—Ä–µ–∑ `Apktool`, –Ω–∞–π—Ç–∏ –∏ —Å–º–µ–Ω–∏—Ç—å —Å—Ç—Ä–æ–∫–∏ `mrim.mail.ru` –∏ `obraz.foto.mail.ru` –Ω–∞ —Å–≤–æ–∏, —Å–æ–±—Ä–∞—Ç—å, –∑–∞—Ç–µ–º –ø–æ–¥–ø–∏—Å–∞—Ç—å.

## –ß—Ç–æ —É–∂–µ —Å–¥–µ–ª–∞–Ω–æ?

- –í—Ö–æ–¥ –≤ –∞–∫–∫–∞—É–Ω—Ç
- –°–º–µ–Ω–∞ —Å—Ç–∞—Ç—É—Å–∞ + Xstatus / –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã (MRA 5.0 –∏ –≤—ã—à–µ; MRIM 1.14 –∏ –≤—ã—à–µ)
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π, –º—É–ª—å—Ç–∏–∫–æ–≤ –∏ –±—É–¥–∏–ª—å–Ω–∏–∫–æ–≤
- –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ü—Ä–æ—Å–º–æ—Ç—Ä –∞–Ω–∫–µ—Ç
- –ò–≥—Ä—ã (–Ω–∞ –≤–µ—Ä—Å–∏—è—Ö MRA 4.2 –¥–æ 5.1)
- –ê–≤–∞—Ç–∞—Ä–∫–∏ (—Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥–º–µ–Ω–∞ hosts –∏–ª–∏ –ø–∞—Ç—á –∫–ª–∏–µ–Ω—Ç–∞)

## –ß—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–æ–ª–æ–≤–∏–Ω—É?

–í –æ—Å–Ω–æ–≤–Ω–æ–º —Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É—é—Ç –ø—Ä—è–º–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏/–∏–ª–∏ –ø—Ä–æ–∫—Å–∏ –º–µ–∂–¥—É –Ω–∏–º–∏:

- –ó–≤–æ–Ω–∫–∏
- –í–∏–¥–µ–æ–∑–≤–æ–Ω–∫–∏
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–∞–π–ª–æ–≤

## –ß—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç?

- –ö–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏
- –ó–≤–æ–Ω–∫–∏ –Ω–∞ MRA >= 5.0
- –ò–≥—Ä—ã –Ω–∞ MRA >= 5.1
- –ú–∏–∫—Ä–æ–±–ª–æ–≥ –Ω–∞ MRA >= 5.5

## Wontfix

- –ù–µ—Ä–∞–±–æ—á–∏–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ –ú–æ–π –ú–∏—Ä, –ü–æ—á—Ç—É –∏ —Ç.–¥. (–Ω–µ –æ—á–µ–Ω—å –∏ –Ω—É–∂–Ω–æ, —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–∞—Ç—á –∫–ª–∏–µ–Ω—Ç–∞, —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–∞–π—Ç–∞, —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è MRIM_CS_GET_MPOP_SESSION)
- –û—Ç–ø—Ä–∞–≤–∫–∞ SMS (–≤–æ–∑–º–æ–∂–Ω–æ, –≤ –±—É–¥—É—â–µ–º, —ç—Ç–æ –±—É–¥–µ—Ç –∑–∞–∫–∞—Å—Ç–æ–º–∏–∑–∏—Ä—É–µ–º–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä –∫–∞–∫ –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —Ç–µ–ª–µ–≥—Ä–∞–º)
